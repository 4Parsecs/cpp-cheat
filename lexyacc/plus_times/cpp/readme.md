c++ version.

i'll focus on the c version as it is more nativelly supported.
